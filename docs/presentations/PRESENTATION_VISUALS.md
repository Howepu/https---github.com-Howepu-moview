# ğŸ“Š ĞŸÑ€ĞµĞ·ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ MoviePortal - ĞŸÑ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ½Ğ°Ñ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ

## Ğ¡Ğ»Ğ°Ğ¹Ğ´ 1: Ğ¢Ğ¸Ñ‚ÑƒĞ»ÑŒĞ½Ñ‹Ğ¹
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                          â”‚
â”‚          ğŸ¬ MoviePortal                  â”‚
â”‚   Ğ’ĞµĞ±-ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ±Ğ°Ğ·Ğ¾Ğ¹ Ñ„Ğ¸Ğ»ÑŒĞ¼Ğ¾Ğ²   â”‚
â”‚                                          â”‚
â”‚   Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ: PHP 8 + PostgreSQL + OAuth â”‚
â”‚   Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ğ»: [Ğ¤Ğ˜Ğ]                       â”‚
â”‚   Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ°: [ĞĞ¾Ğ¼ĞµÑ€]                       â”‚
â”‚   Ğ”Ğ°Ñ‚Ğ°: 10.01.2026                      â”‚
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Ğ¡Ğ»Ğ°Ğ¹Ğ´ 2: Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ ÑÑ‚ĞµĞº

**Backend:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHP 8.2                             â”‚
â”‚ â€¢ Typed properties                  â”‚
â”‚ â€¢ Match expressions                 â”‚
â”‚ â€¢ Named arguments                   â”‚
â”‚ â€¢ JIT compilation                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PostgreSQL 12                       â”‚
â”‚ â€¢ JSONB support                     â”‚
â”‚ â€¢ Full-text search (tsvector)       â”‚
â”‚ â€¢ RETURNING clause                  â”‚
â”‚ â€¢ Advanced indexing (B-tree, GIN)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PDO (PHP Data Objects)              â”‚
â”‚ â€¢ Prepared statements               â”‚
â”‚ â€¢ Transaction support               â”‚
â”‚ â€¢ Multiple database drivers         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Frontend:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HTML5                               â”‚
â”‚ â€¢ Semantic markup                   â”‚
â”‚ â€¢ Schema.org microdata              â”‚
â”‚ â€¢ SEO optimization                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CSS3                                â”‚
â”‚ â€¢ Flexbox layouts                   â”‚
â”‚ â€¢ Media queries (responsive)        â”‚
â”‚ â€¢ CSS Grid                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Vanilla JavaScript (ES6+)           â”‚
â”‚ â€¢ Fetch API                         â”‚
â”‚ â€¢ Arrow functions                   â”‚
â”‚ â€¢ Async/await                       â”‚
â”‚ â€¢ Event delegation                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**DevOps & Infrastructure:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Docker Compose                      â”‚
â”‚ â€¢ Multi-container orchestration     â”‚
â”‚ â€¢ Volume management                 â”‚
â”‚ â€¢ Network isolation                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Nginx 1.21                          â”‚
â”‚ â€¢ Reverse proxy                     â”‚
â”‚ â€¢ Gzip compression                  â”‚
â”‚ â€¢ Static file caching               â”‚
â”‚ â€¢ FastCGI protocol                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PHP-FPM                             â”‚
â”‚ â€¢ Process manager                   â”‚
â”‚ â€¢ OPcache optimization              â”‚
â”‚ â€¢ Connection pooling                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Authentication:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OAuth 2.0 Providers                 â”‚
â”‚ â€¢ Yandex ID                         â”‚
â”‚ â€¢ Telegram Bot API                  â”‚
â”‚ â€¢ VKontakte OAuth                   â”‚
â”‚                                     â”‚
â”‚ Authorization Code Flow             â”‚
â”‚ â€¢ State parameter (CSRF protection) â”‚
â”‚ â€¢ Access tokens                     â”‚
â”‚ â€¢ Refresh tokens                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ Ğ¸Ğ¼ĞµĞ½Ğ½Ğ¾ ÑÑ‚Ğ¾Ñ‚ ÑÑ‚ĞµĞº:**

| Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ | ĞĞ»ÑŒÑ‚ĞµÑ€Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ° | Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ¾Ğ±Ğ¾ÑĞ½Ğ¾Ğ²Ğ°Ğ½ |
|------------|--------------|-----------------|
| **PHP 8** | Node.js, Python | ĞŸÑ€Ğ¾ÑÑ‚Ğ¾Ñ‚Ğ° Ğ´ĞµĞ¿Ğ»Ğ¾Ñ, Ğ²ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ñ‹Ğµ ÑĞµÑÑĞ¸Ğ¸, PDO |
| **PostgreSQL** | MySQL, MongoDB | JSONB, full-text search, ÑĞ»Ğ¾Ğ¶Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ |
| **Docker** | XAMPP, Ñ€ÑƒÑ‡Ğ½Ğ°Ñ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° | Ğ˜Ğ·Ğ¾Ğ»ÑÑ†Ğ¸Ñ, Ğ²Ğ¾ÑĞ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ, ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒ |
| **Nginx** | Apache | ĞœĞµĞ½ÑŒÑˆĞµ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸, async I/O, reverse proxy |
| **Vanilla JS** | jQuery, React | ĞĞµÑ‚ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹, Ğ¼ĞµĞ½ÑŒÑˆĞµ Ğ±Ğ°Ğ½Ğ´Ğ», Ğ±Ñ‹ÑÑ‚Ñ€ĞµĞµ |

**ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ÑÑ‚ĞµĞºĞ°:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Browser (Client)                 â”‚
â”‚  HTML5 + CSS3 + Vanilla JavaScript         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ HTTP/HTTPS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Nginx :80                        â”‚
â”‚  Reverse Proxy + Static Files              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ FastCGI
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           PHP-FPM :9000                    â”‚
â”‚  Business Logic + PDO                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ PDO Driver
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         PostgreSQL :5432                   â”‚
â”‚  Data Storage + Indexes                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ğ’ĞµÑ€ÑĞ¸Ğ¸ Ğ¸ ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ:**
- PHP: 8.2+ (Ğ¼Ğ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ 8.0)
- PostgreSQL: 12+ (Ğ´Ğ»Ñ GENERATED ALWAYS AS)
- Docker: 20.10+
- Docker Compose: 2.0+

---

## Ğ¡Ğ»Ğ°Ğ¹Ğ´ 3: ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ - Docker Compose

**Ğ¢Ñ€Ñ‘Ñ…Ğ·Ğ²ĞµĞ½Ğ½Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ² ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°Ñ…:**

```yaml
# docker-compose.yml
version: '3.8'

services:
  # Ğ’ĞµĞ±-ÑĞµÑ€Ğ²ĞµÑ€ (reverse proxy)
  nginx:
    build: ./nginx
    ports: ["80:80"]
    depends_on: [php, postgres]
    volumes:
      - ./public:/var/www/html/public
    
  # Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ Ğ±Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ¸
  php:
    build: ./php
    environment:
      DB_HOST: postgres
      DB_NAME: movie_portal
      DB_USER: postgres
      
  # Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
  postgres:
    image: postgres:12
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./postgres/init.sql:/docker-entrypoint-initdb.d/
    ports: ["5432:5432"]
```

**ĞŸĞ¾Ñ‚Ğ¾Ğº Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°:**
```
Browser â†’ Nginx:80 â†’ PHP-FPM â†’ PostgreSQL â†’ Response
```

**ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ°:**
- Ğ˜Ğ·Ğ¾Ğ»ÑÑ†Ğ¸Ñ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¾Ğ² Ğ² ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°Ñ…
- ĞŸÑ€Ğ¾ÑÑ‚Ğ¾Ğµ Ñ€Ğ°Ğ·Ğ²ĞµÑ€Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ğµ: `docker-compose up`
- ĞĞµĞ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾Ğµ Ğ¼Ğ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²
- Ğ’Ğ¾ÑĞ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ğ¼Ğ°Ñ ÑÑ€ĞµĞ´Ğ° (dev = prod)

---

## Ğ¡Ğ»Ğ°Ğ¹Ğ´ 3: Ğ¡Ğ»Ğ¾Ğ¹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… - PostgreSQL Schema

**ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… (4 Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ + ÑĞ²ÑĞ·Ğ¸):**

```sql
-- 1. Ğ ĞµĞ¶Ğ¸ÑÑĞµÑ€Ñ‹
CREATE TABLE directors (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL UNIQUE,
    bio TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 2. Ğ¤Ğ¸Ğ»ÑŒĞ¼Ñ‹ Ñ Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ğ¼ ĞºĞ»ÑÑ‡Ğ¾Ğ¼
CREATE TABLE movies (
    id SERIAL PRIMARY KEY,
    title VARCHAR(255) NOT NULL,
    year INTEGER CHECK (year BETWEEN 1888 AND 2100),
    director_id INTEGER REFERENCES directors(id) 
        ON DELETE CASCADE,
    rating DECIMAL(3,1) CHECK (rating BETWEEN 0 AND 10),
    poster_url TEXT,
    description TEXT
);

-- 3. Ğ–Ğ°Ğ½Ñ€Ñ‹
CREATE TABLE genres (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL UNIQUE
);

-- 4. Ğ¡Ğ²ÑĞ·ÑŒ Ğ¼Ğ½Ğ¾Ğ³Ğ¸Ğµ-ĞºĞ¾-Ğ¼Ğ½Ğ¾Ğ³Ğ¸Ğ¼
CREATE TABLE movie_genres (
    movie_id INTEGER REFERENCES movies(id) ON DELETE CASCADE,
    genre_id INTEGER REFERENCES genres(id) ON DELETE CASCADE,
    PRIMARY KEY (movie_id, genre_id)
);

-- Ğ˜Ğ½Ğ´ĞµĞºÑÑ‹ Ğ´Ğ»Ñ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ¾Ğ¸ÑĞºĞ°
CREATE INDEX idx_movies_title ON movies USING btree(title);
CREATE INDEX idx_movies_year ON movies(year);
CREATE INDEX idx_movies_rating ON movies(rating DESC);
CREATE INDEX idx_directors_name ON directors(name);
```

**ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ:**
- **ĞĞ¾Ñ€Ğ¼Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ 3ĞĞ¤** - Ğ¸Ğ·Ğ±ĞµĞ³Ğ°Ğ½Ğ¸Ğµ Ğ´ÑƒĞ±Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
- **Referential Integrity** - FOREIGN KEY + CASCADE
- **CHECK constraints** - Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ½Ğ° ÑƒÑ€Ğ¾Ğ²Ğ½Ğµ Ğ‘Ğ”
- **B-tree Ğ¸Ğ½Ğ´ĞµĞºÑÑ‹** - Ğ±Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº O(log n)
- **Ğ¡Ğ¾ÑÑ‚Ğ°Ğ²Ğ½Ğ¾Ğ¹ PRIMARY KEY** - Ğ´Ğ»Ñ many-to-many Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹

---

## Ğ¡Ğ»Ğ°Ğ¹Ğ´ 4: Ğ¡Ğ»Ğ¾Ğ¹ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ° Ğº Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼ - PDO Wrapper

**Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾Ğµ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ (config.php):**

```php
<?php
// Singleton Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ
define('DB_HOST', getenv('DB_HOST') ?: 'postgres');
define('DB_NAME', getenv('DB_NAME') ?: 'movie_portal');
define('DB_USER', getenv('DB_USER') ?: 'postgres');
define('DB_PASS', getenv('DB_PASSWORD') ?: 'postgres');

try {
    $pdo = new PDO(
        "pgsql:host=" . DB_HOST . ";dbname=" . DB_NAME,
        DB_USER,
        DB_PASS,
        [
            // Ğ ĞµĞ¶Ğ¸Ğ¼ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¹ Ğ´Ğ»Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
            PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
            
            // ĞÑÑĞ¾Ñ†Ğ¸Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ Ğ¼Ğ°ÑÑĞ¸Ğ²Ñ‹ Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ
            PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,
            
            // Persistent connections Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
            PDO::ATTR_PERSISTENT => true
        ]
    );
    
    // ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ·Ğ°Ğ¿ÑƒÑĞº Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¹
    require_once __DIR__ . '/includes/migrations.php';
    runDatabaseMigrations($pdo);
    
} catch (PDOException $e) {
    error_log("DB Connection Error: " . $e->getMessage());
    http_response_code(500);
    die("Database unavailable");
}
```

**Prepared Statements - Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ SQL Injection:**

```php
// films.php - ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ñ„Ğ¸Ğ»ÑŒĞ¼Ğ¾Ğ² Ñ Ğ´Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¹ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸ĞµĞ¹
$genre = $_GET['genre'] ?? null;
$year = $_GET['year'] ?? null;

$sql = "SELECT m.*, d.name AS director_name,
        STRING_AGG(g.name, ', ') AS genres
        FROM movies m
        JOIN directors d ON m.director_id = d.id
        LEFT JOIN movie_genres mg ON m.id = mg.movie_id
        LEFT JOIN genres g ON mg.genre_id = g.id
        WHERE 1=1";

$params = [];

// Ğ”Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ğ¹
if ($genre) {
    $sql .= " AND EXISTS (
        SELECT 1 FROM movie_genres mg2
        JOIN genres g2 ON mg2.genre_id = g2.id
        WHERE mg2.movie_id = m.id AND g2.name = ?
    )";
    $params[] = $genre;
}

if ($year) {
    $sql .= " AND m.year = ?";
    $params[] = $year;
}

$sql .= " GROUP BY m.id, d.name ORDER BY m.title";

// Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾Ğµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ
$stmt = $pdo->prepare($sql);
$stmt->execute($params);
$movies = $stmt->fetchAll();
```

**ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ ÑÑ‚Ğ¾ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾:**
- ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ Ğ¾Ñ‚Ğ´ĞµĞ»ĞµĞ½Ñ‹ Ğ¾Ñ‚ SQL-ĞºĞ¾Ğ´Ğ°
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ ÑĞºÑ€Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ²ÑĞµÑ… Ñ‚Ğ¸Ğ¿Ğ¾Ğ² Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
- ĞĞµĞ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ° SQL-Ğ¸Ğ½ÑŠĞµĞºÑ†Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ· Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒÑĞºĞ¸Ğ¹ Ğ²Ğ²Ğ¾Ğ´

---

## Ğ¡Ğ»Ğ°Ğ¹Ğ´ 5: REST API Ğ´Ğ»Ñ AJAX-Ğ¿Ğ¾Ğ¸ÑĞºĞ°

**Ğ¡ĞµÑ€Ğ²ĞµÑ€Ğ½Ğ°Ñ Ñ‡Ğ°ÑÑ‚ÑŒ (search.php):**

```php
<?php
header('Content-Type: application/json; charset=utf-8');
require_once 'config.php';

$query = $_GET['q'] ?? '';

// Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ²Ñ…Ğ¾Ğ´Ğ½Ñ‹Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
if (strlen($query) < 2) {
    echo json_encode([]);
    exit;
}

// Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ XSS Ğ¸ SQL injection Ñ‡ĞµÑ€ĞµĞ· prepared statement
$stmt = $pdo->prepare("
    SELECT DISTINCT 
        m.id, 
        m.title, 
        m.year, 
        d.name AS director,
        m.rating,
        m.poster_url
    FROM movies m
    JOIN directors d ON m.director_id = d.id
    WHERE 
        m.title ILIKE ? OR 
        d.name ILIKE ?
    ORDER BY m.rating DESC NULLS LAST
    LIMIT 10
");

$searchPattern = "%{$query}%";
$stmt->execute([$searchPattern, $searchPattern]);

// Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ° Ğ² JSON
echo json_encode($stmt->fetchAll(), JSON_UNESCAPED_UNICODE);
```

**ĞšĞ»Ğ¸ĞµĞ½Ñ‚ÑĞºĞ°Ñ Ñ‡Ğ°ÑÑ‚ÑŒ (search.js):**

```javascript
const searchInput = document.getElementById('search');
const resultsDiv = document.getElementById('results');
let debounceTimer;

searchInput.addEventListener('input', (e) => {
    // ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° Ğ¿Ñ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰ĞµĞ³Ğ¾ Ñ‚Ğ°Ğ¹Ğ¼ĞµÑ€Ğ°
    clearTimeout(debounceTimer);
    
    // Debounce Ğ´Ğ»Ñ ÑĞ½Ğ¸Ğ¶ĞµĞ½Ğ¸Ñ Ğ½Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ Ğ½Ğ° ÑĞµÑ€Ğ²ĞµÑ€
    debounceTimer = setTimeout(() => {
        const query = e.target.value.trim();
        
        if (query.length < 2) {
            resultsDiv.innerHTML = '';
            resultsDiv.classList.remove('active');
            return;
        }
        
        // Fetch API Ğ´Ğ»Ñ AJAX Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°
        fetch(`search.php?q=${encodeURIComponent(query)}`)
            .then(response => {
                if (!response.ok) throw new Error('Network error');
                return response.json();
            })
            .then(movies => {
                if (movies.length === 0) {
                    resultsDiv.innerHTML = '<div class="no-results">ĞĞ¸Ñ‡ĞµĞ³Ğ¾ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾</div>';
                } else {
                    resultsDiv.innerHTML = movies.map(movie => `
                        <a href="film_page.php?id=${movie.id}" class="search-result">
                            ${movie.poster_url ? 
                                `<img src="${movie.poster_url}" alt="${movie.title}">` : ''}
                            <div class="result-info">
                                <strong>${movie.title}</strong> (${movie.year})
                                <span>Ğ ĞµĞ¶Ğ¸ÑÑÑ‘Ñ€: ${movie.director}</span>
                                ${movie.rating ? `<span>â­ ${movie.rating}</span>` : ''}
                            </div>
                        </a>
                    `).join('');
                }
                resultsDiv.classList.add('active');
            })
            .catch(err => {
                console.error('Search error:', err);
                resultsDiv.innerHTML = '<div class="error">ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ğ¾Ğ¸ÑĞºĞ°</div>';
            });
    }, 300); // Ğ—Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ° 300ms
});

// Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ² Ğ¿Ñ€Ğ¸ ĞºĞ»Ğ¸ĞºĞµ Ğ²Ğ½Ğµ
document.addEventListener('click', (e) => {
    if (!searchInput.contains(e.target) && !resultsDiv.contains(e.target)) {
        resultsDiv.classList.remove('active');
    }
});
```

**Ğ¢ĞµÑ…Ğ½Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ:**
1. **ILIKE** - Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¾Ğ½ĞµĞ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ñ‹Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº (PostgreSQL)
2. **Debouncing** - Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ° Ğ´Ğ»Ñ Ğ¿Ñ€ĞµĞ´Ğ¾Ñ‚Ğ²Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ñ Ğ»Ğ¸ÑˆĞ½Ğ¸Ñ… Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²
3. **JSON API** - ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ğ¾Ğ±Ğ¼ĞµĞ½ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸
4. **Error handling** - Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° ÑĞµÑ‚ĞµĞ²Ñ‹Ñ… Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
5. **encodeURIComponent** - Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ XSS

---

## Ğ¡Ğ»Ğ°Ğ¹Ğ´ 6: ĞĞ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ°Ñ Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ - CRUD + Security

**Middleware Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ (admin/auth.php):**

```php
<?php
session_start();

function requireAdmin() {
    if (!isset($_SESSION['admin_logged_in'])) {
        header('Location: login.php');
        exit;
    }
    
    // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½ĞµĞ¹ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸
    $_SESSION['last_activity'] = time();
}

function generateCSRFToken() {
    if (!isset($_SESSION['csrf_token'])) {
        $_SESSION['csrf_token'] = bin2hex(random_bytes(32));
    }
    return $_SESSION['csrf_token'];
}

function verifyCSRFToken($token) {
    return isset($_SESSION['csrf_token']) && 
           hash_equals($_SESSION['csrf_token'], $token);
}

requireAdmin();
```

**CRUD Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ñ Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸ÑĞ¼Ğ¸ (admin/movies.php):**

```php
<?php
require_once 'auth.php';
require_once '../config.php';

// CREATE - Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ„Ğ¸Ğ»ÑŒĞ¼Ğ°
if ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['add'])) {
    // CSRF Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ°
    if (!verifyCSRFToken($_POST['csrf_token'])) {
        die('CSRF token validation failed');
    }
    
    // Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ¸ ÑĞ°Ğ½Ğ¸Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ²Ñ…Ğ¾Ğ´Ğ½Ñ‹Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
    $title = trim($_POST['title']);
    $year = filter_var($_POST['year'], FILTER_VALIDATE_INT);
    $director_id = filter_var($_POST['director_id'], FILTER_VALIDATE_INT);
    $rating = filter_var($_POST['rating'], FILTER_VALIDATE_FLOAT);
    
    // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ½Ğ¾ÑÑ‚Ğ¸
    if (empty($title)) {
        $error = "ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾";
    } elseif ($year < 1888 || $year > 2100) {
        $error = "Ğ“Ğ¾Ğ´ Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ±Ñ‹Ñ‚ÑŒ Ğ¾Ñ‚ 1888 Ğ´Ğ¾ 2100";
    } elseif ($rating < 0 || $rating > 10) {
        $error = "Ğ ĞµĞ¹Ñ‚Ğ¸Ğ½Ğ³ Ğ¾Ñ‚ 0 Ğ´Ğ¾ 10";
    } else {
        // Ğ¢Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ñ Ğ´Ğ»Ñ Ğ°Ñ‚Ğ¾Ğ¼Ğ°Ñ€Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹
        $pdo->beginTransaction();
        
        try {
            // 1. Ğ’ÑÑ‚Ğ°Ğ²ĞºĞ° Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸
            $stmt = $pdo->prepare("
                INSERT INTO movies 
                (title, year, director_id, rating, poster_url, description)
                VALUES (?, ?, ?, ?, ?, ?)
                RETURNING id
            ");
            
            $stmt->execute([
                $title,
                $year,
                $director_id,
                $rating,
                $_POST['poster_url'] ?? null,
                $_POST['description'] ?? null
            ]);
            
            $movie_id = $stmt->fetchColumn();
            
            // 2. Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑĞ²ÑĞ·ĞµĞ¹ Ñ Ğ¶Ğ°Ğ½Ñ€Ğ°Ğ¼Ğ¸ (many-to-many)
            if (!empty($_POST['genres']) && is_array($_POST['genres'])) {
                $genreStmt = $pdo->prepare("
                    INSERT INTO movie_genres (movie_id, genre_id)
                    VALUES (?, ?)
                ");
                
                foreach ($_POST['genres'] as $genre_id) {
                    $genre_id = filter_var($genre_id, FILTER_VALIDATE_INT);
                    if ($genre_id) {
                        $genreStmt->execute([$movie_id, $genre_id]);
                    }
                }
            }
            
            // ĞŸĞ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ğµ Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¸
            $pdo->commit();
            
            $success = "Ğ¤Ğ¸Ğ»ÑŒĞ¼ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½ (ID: {$movie_id})";
            
            // Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ
            error_log("Admin {$_SESSION['admin_id']} added movie: {$title}");
            
        } catch (PDOException $e) {
            // ĞÑ‚ĞºĞ°Ñ‚ Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¸ Ğ¿Ñ€Ğ¸ Ğ¾ÑˆĞ¸Ğ±ĞºĞµ
            $pdo->rollBack();
            $error = "ĞÑˆĞ¸Ğ±ĞºĞ° Ğ‘Ğ”: " . $e->getMessage();
            error_log("Movie creation failed: " . $e->getMessage());
        }
    }
}

// DELETE - Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ñ„Ğ¸Ğ»ÑŒĞ¼Ğ°
if ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['delete'])) {
    if (!verifyCSRFToken($_POST['csrf_token'])) {
        die('CSRF token validation failed');
    }
    
    $id = filter_var($_POST['id'], FILTER_VALIDATE_INT);
    
    // CASCADE ÑƒĞ´Ğ°Ğ»Ğ¸Ñ‚ ÑĞ²ÑĞ·Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸ Ğ² movie_genres
    $stmt = $pdo->prepare("DELETE FROM movies WHERE id = ?");
    $stmt->execute([$id]);
    
    $success = "Ğ¤Ğ¸Ğ»ÑŒĞ¼ ÑƒĞ´Ğ°Ğ»ĞµĞ½";
}
```

**ĞŸĞ°Ñ‚Ñ‚ĞµÑ€Ğ½Ñ‹ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸:**
1. âœ… **Session-based Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ**
2. âœ… **CSRF token Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ°** (hash_equals Ğ´Ğ»Ñ timing-safe ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ)
3. âœ… **Input validation** (filter_var)
4. âœ… **Database transactions** (ACID Ğ³Ğ°Ñ€Ğ°Ğ½Ñ‚Ğ¸Ğ¸)
5. âœ… **Prepared statements** (SQL injection Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ°)
6. âœ… **Output escaping** (htmlspecialchars Ğ´Ğ»Ñ XSS Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ñ‹)
7. âœ… **Error logging** (Ğ½Ğµ Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ´ĞµÑ‚Ğ°Ğ»Ğ¸ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ)

---

## Ğ¡Ğ»Ğ°Ğ¹Ğ´ 7: OAuth 2.0 Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ - Yandex ID

**ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ OAuth (yandex_config.php):**

```php
<?php
// ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Yandex OAuth Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ
define('YANDEX_CLIENT_ID', '0a05754ab8594f6a97437159055427ee');
define('YANDEX_CLIENT_SECRET', '117914f90f964c09ae9920f5ed705044');
define('YANDEX_REDIRECT_URI', 'http://127.0.0.1/admin/yandex_callback.php');

/**
 * Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ URL Ğ´Ğ»Ñ Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ Ñ‡ĞµÑ€ĞµĞ· Yandex ID
 */
function getYandexAuthUrl() {
    $params = [
        'response_type' => 'code',
        'client_id' => YANDEX_CLIENT_ID,
        'redirect_uri' => YANDEX_REDIRECT_URI,
        'scope' => 'login:info',  // Ğ—Ğ°Ğ¿Ñ€Ğ¾Ñ Ğ±Ğ°Ğ·Ğ¾Ğ²Ğ¾Ğ¹ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸
        'state' => bin2hex(random_bytes(16))  // CSRF Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ°
    ];
    
    // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ state Ğ² ÑĞµÑÑĞ¸Ğ¸ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸
    session_start();
    $_SESSION['yandex_oauth_state'] = $params['state'];
    
    return 'https://oauth.yandex.ru/authorize?' . http_build_query($params);
}

/**
 * ĞĞ±Ğ¼ĞµĞ½ authorization code Ğ½Ğ° access token
 */
function getYandexAccessToken($code, $state) {
    session_start();
    
    // CSRF Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ° - Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° state
    if (!isset($_SESSION['yandex_oauth_state']) || 
        $_SESSION['yandex_oauth_state'] !== $state) {
        throw new Exception('Invalid state parameter - CSRF detected');
    }
    
    unset($_SESSION['yandex_oauth_state']);
    
    $params = [
        'grant_type' => 'authorization_code',
        'code' => $code,
        'redirect_uri' => YANDEX_REDIRECT_URI,
        'client_id' => YANDEX_CLIENT_ID,
        'client_secret' => YANDEX_CLIENT_SECRET
    ];
    
    // POST Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ Ğº Yandex OAuth ÑĞµÑ€Ğ²ĞµÑ€Ñƒ
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, 'https://oauth.yandex.ru/token');
    curl_setopt($ch, CURLOPT_POST, true);
    curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($params));
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    
    $response = curl_exec($ch);
    curl_close($ch);
    
    return json_decode($response, true);
}
```

**Ğ¡ĞµÑ€Ğ²ĞµÑ€Ğ½Ñ‹Ğ¹ callback (yandex_callback.php):**

```php
<?php
session_start();
require_once '../config.php';
require_once 'yandex_config.php';

// ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ authorization code Ğ¸ state
if (!isset($_GET['code']) || !isset($_GET['state'])) {
    http_response_code(400);
    die('Missing authorization code or state');
}

try {
    // 1. ĞĞ±Ğ¼ĞµĞ½ code Ğ½Ğ° access token
    $token_data = getYandexAccessToken($_GET['code'], $_GET['state']);
    
    if (!isset($token_data['access_token'])) {
        throw new Exception('Failed to obtain access token');
    }
    
    $access_token = $token_data['access_token'];
    
    // 2. ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸ Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğµ
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, 'https://login.yandex.ru/info');
    curl_setopt($ch, CURLOPT_HTTPHEADER, [
        "Authorization: OAuth {$access_token}"
    ]);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    
    $response = curl_exec($ch);
    curl_close($ch);
    
    $user_data = json_decode($response, true);
    
    if (!$user_data || !isset($user_data['id'])) {
        throw new Exception('Failed to get user info');
    }
    
    // 3. Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ/Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ (UPSERT)
    $stmt = $pdo->prepare("
        SELECT id, username, role 
        FROM admin_users 
        WHERE yandex_id = ?
    ");
    $stmt->execute([$user_data['id']]);
    $admin_user = $stmt->fetch();
    
    if ($admin_user) {
        // ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½ - Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ÑĞµĞ¼ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
        $update_stmt = $pdo->prepare("
            UPDATE admin_users 
            SET last_login = CURRENT_TIMESTAMP,
                yandex_login = ?,
                yandex_email = ?,
                yandex_avatar_url = ?,
                yandex_access_token = ?
            WHERE id = ?
        ");
        
        $avatar_url = isset($user_data['default_avatar_id']) 
            ? "https://avatars.yandex.net/get-yapic/{$user_data['default_avatar_id']}/islands-200"
            : null;
        
        $update_stmt->execute([
            $user_data['login'] ?? '',
            $user_data['default_email'] ?? '',
            $avatar_url,
            $access_token,
            $admin_user['id']
        ]);
        
        // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ ÑĞµÑÑĞ¸Ğ¸
        session_regenerate_id(true);  // Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ session fixation
        $_SESSION['admin_logged_in'] = true;
        $_SESSION['admin_id'] = $admin_user['id'];
        $_SESSION['admin_username'] = $admin_user['username'];
        $_SESSION['admin_role'] = $admin_user['role'];
        $_SESSION['yandex_authorized'] = true;
        
        // Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
        error_log("Yandex OAuth: User {$user_data['id']} logged in");
        
        header('Location: index.php');
        exit;
    } else {
        // ĞĞ¾Ğ²Ñ‹Ğ¹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ - ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
        $_SESSION['yandex_temp_data'] = [
            'id' => $user_data['id'],
            'login' => $user_data['login'] ?? '',
            'email' => $user_data['default_email'] ?? '',
            'avatar_url' => $avatar_url,
            'access_token' => $access_token
        ];
        
        // ĞŸĞµÑ€ĞµĞ½Ğ°Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ° ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ñƒ Ğ¿Ñ€Ğ¸Ğ²ÑĞ·ĞºĞ¸ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ğ°
        header('Location: yandex_link_account.php');
        exit;
    }
    
} catch (Exception $e) {
    error_log("Yandex OAuth error: " . $e->getMessage());
    http_response_code(500);
    die('Authentication failed: ' . $e->getMessage());
}
```

**OAuth 2.0 Authorization Code Flow:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Browser â”‚              â”‚   Yandex   â”‚            â”‚ Server â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚                          â”‚                      â”‚
     â”‚  1. Redirect to Yandex   â”‚                      â”‚
     â”‚  /authorize?client_id... â”‚                      â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                      â”‚
     â”‚                          â”‚                      â”‚
     â”‚  2. Show Login Form      â”‚                      â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚
     â”‚                          â”‚                      â”‚
     â”‚  3. User Login + Consent â”‚                      â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                      â”‚
     â”‚                          â”‚                      â”‚
     â”‚  4. Redirect with code   â”‚                      â”‚
     â”‚  /callback?code=xxx      â”‚                      â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                                5. Exchange code  â”‚
     â”‚                                   for token (POST)â”‚
     â”‚                                6. Get user info  â”‚
     â”‚                                7. Create session â”‚
     â”‚                                                  â”‚
     â”‚  8. Redirect to admin panel                     â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                                                  â”‚
```

**ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚Ñ‹ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸:**
1. âœ… **Authorization Code Flow** - ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚ OAuth 2.0
2. âœ… **State parameter** - Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ CSRF Ğ°Ñ‚Ğ°Ğº
3. âœ… **Client Secret** - ÑĞµÑ€Ğ²ĞµÑ€Ğ½Ğ°Ñ Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ
4. âœ… **Session regeneration** - Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ session fixation
5. âœ… **HTTPS required** - Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ°Ñ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‡Ğ° Ñ‚Ğ¾ĞºĞµĞ½Ğ¾Ğ² (Ğ² Ğ¿Ñ€Ğ¾Ğ´Ğ°ĞºÑˆĞ½Ğµ)
6. âœ… **Access token storage** - Ğ´Ğ»Ñ Ğ¿Ğ¾ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ñ… API Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²

---

## Ğ¡Ğ»Ğ°Ğ¹Ğ´ 8: ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ‘Ğ”

**Ğ’ĞµÑ€ÑĞ¸Ğ¾Ğ½Ğ½Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¹ (includes/migrations.php):**

```php
<?php

/**
 * Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¹ Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ ÑĞ²Ğ¾Ğ»ÑÑ†Ğ¸ĞµĞ¹ ÑÑ…ĞµĞ¼Ñ‹ Ğ‘Ğ”
 * Ğ˜Ğ´ĞµĞ¼Ğ¿Ğ¾Ñ‚ĞµĞ½Ñ‚Ğ½Ñ‹Ğµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ - Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°Ñ‚ÑŒ Ğ¼Ğ½Ğ¾Ğ³Ğ¾ĞºÑ€Ğ°Ñ‚Ğ½Ğ¾
 */
function runDatabaseMigrations($pdo) {
    try {
        // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ ÑĞ»ÑƒĞ¶ĞµĞ±Ğ½Ğ¾Ğ¹ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ Ğ´Ğ»Ñ Ğ¾Ñ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ğ½Ğ¸Ñ Ğ²ĞµÑ€ÑĞ¸Ğ¹
        $pdo->exec("
            CREATE TABLE IF NOT EXISTS schema_migrations (
                version INTEGER PRIMARY KEY,
                description TEXT,
                applied_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
            )
        ");
        
        // ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ¹ Ğ²ĞµÑ€ÑĞ¸Ğ¸ ÑÑ…ĞµĞ¼Ñ‹
        $stmt = $pdo->query("
            SELECT COALESCE(MAX(version), 0) AS current_version 
            FROM schema_migrations
        ");
        $current = $stmt->fetch()['current_version'];
        
        // === ĞœĞ˜Ğ“Ğ ĞĞ¦Ğ˜Ğ¯ 1: ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ğµ Ğ¸Ğ½Ğ´ĞµĞºÑÑ‹ ===
        if ($current < 1) {
            $pdo->exec("
                CREATE INDEX IF NOT EXISTS idx_movies_rating 
                ON movies(rating DESC NULLS LAST);
                
                CREATE INDEX IF NOT EXISTS idx_movies_created 
                ON movies(created_at DESC);
            ");
            
            $pdo->exec("
                INSERT INTO schema_migrations (version, description)
                VALUES (1, 'Added performance indexes')
            ");
            
            error_log("Migration 1: Performance indexes applied");
        }
        
        // === ĞœĞ˜Ğ“Ğ ĞĞ¦Ğ˜Ğ¯ 2: Full-text search ===
        if ($current < 2) {
            $pdo->exec("
                -- Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ tsvector ĞºĞ¾Ğ»Ğ¾Ğ½ĞºĞ¸
                ALTER TABLE movies 
                ADD COLUMN IF NOT EXISTS search_vector tsvector
                GENERATED ALWAYS AS (
                    setweight(to_tsvector('russian', coalesce(title, '')), 'A') ||
                    setweight(to_tsvector('russian', coalesce(description, '')), 'B')
                ) STORED;
                
                -- GIN Ğ¸Ğ½Ğ´ĞµĞºÑ Ğ´Ğ»Ñ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ¸ÑĞºĞ°
                CREATE INDEX IF NOT EXISTS idx_movies_fts 
                ON movies USING gin(search_vector);
            ");
            
            $pdo->exec("
                INSERT INTO schema_migrations (version, description)
                VALUES (2, 'Added full-text search')
            ");
            
            error_log("Migration 2: Full-text search enabled");
        }
        
        // === ĞœĞ˜Ğ“Ğ ĞĞ¦Ğ˜Ğ¯ 3: Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° Ğ°ÑƒĞ´Ğ¸Ñ‚Ğ° ===
        if ($current < 3) {
            $pdo->exec("
                CREATE TABLE IF NOT EXISTS audit_log (
                    id SERIAL PRIMARY KEY,
                    table_name VARCHAR(50),
                    operation VARCHAR(10),
                    record_id INTEGER,
                    admin_id INTEGER,
                    changed_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
                    old_data JSONB,
                    new_data JSONB
                );
                
                CREATE INDEX idx_audit_table ON audit_log(table_name);
                CREATE INDEX idx_audit_time ON audit_log(changed_at DESC);
            ");
            
            $pdo->exec("
                INSERT INTO schema_migrations (version, description)
                VALUES (3, 'Added audit logging')
            ");
        }
        
        return [
            'success' => true,
            'current_version' => $current,
            'message' => "Migrations complete (version {$current})"
        ];
        
    } catch (PDOException $e) {
        error_log("Migration failed: " . $e->getMessage());
        return ['success' => false, 'message' => $e->getMessage()];
    }
}
```

**ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ°:**
- âœ… **Ğ’ĞµÑ€ÑĞ¸Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ÑÑ…ĞµĞ¼Ñ‹** - ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ÑŒ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¹
- âœ… **Ğ˜Ğ´ĞµĞ¼Ğ¿Ğ¾Ñ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ** - Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾Ğµ Ğ¿Ğ¾Ğ²Ñ‚Ğ¾Ñ€Ğ½Ğ¾Ğµ Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ
- âœ… **ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ** - Ğ¿Ñ€Ğ¸ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¼ Ğ´ĞµĞ¿Ğ»Ğ¾Ğµ
- âœ… **Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¹** - Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° schema_migrations

---

## Ğ¡Ğ»Ğ°Ğ¹Ğ´ 9: ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¸ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ

**Nginx ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ (nginx/nginx.conf):**

```nginx
server {
    listen 80;
    server_name localhost;
    root /var/www/html/public;
    index index.php;
    
    # Gzip ÑĞ¶Ğ°Ñ‚Ğ¸Ğµ
    gzip on;
    gzip_vary on;
    gzip_min_length 256;
    gzip_types
        text/plain text/css text/javascript
        application/javascript application/json;
    
    # ĞšÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ÑÑ‚Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²
    location ~* \.(css|js|jpg|png|svg|woff2)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
    
    # PHP-FPM Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°
    location ~ \.php$ {
        fastcgi_pass php:9000;
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include fastcgi_params;
    }
    
    # Security headers
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-XSS-Protection "1; mode=block" always;
}
```

**PostgreSQL Ğ¸Ğ½Ğ´ĞµĞºÑÑ‹:**

```sql
-- Composite index Ğ´Ğ»Ñ Ñ‡Ğ°ÑÑ‚Ñ‹Ñ… Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²
CREATE INDEX idx_movies_year_rating ON movies(year, rating DESC);

-- Partial index Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ¿ÑƒĞ»ÑÑ€Ğ½Ñ‹Ñ… Ñ„Ğ¸Ğ»ÑŒĞ¼Ğ¾Ğ²
CREATE INDEX idx_high_rated ON movies(rating) 
WHERE rating >= 8.0;

-- Expression index Ğ´Ğ»Ñ case-insensitive Ğ¿Ğ¾Ğ¸ÑĞºĞ°
CREATE INDEX idx_title_lower ON movies(LOWER(title));
```

**ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸:**
- Ğ’Ñ€ĞµĞ¼Ñ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ° Ğ³Ğ»Ğ°Ğ²Ğ½Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹: **< 100ms**
- AJAX Ğ¿Ğ¾Ğ¸ÑĞº: **< 50ms**
- HTML Ñ gzip: **~15KB** (Ğ²Ğ¼ĞµÑÑ‚Ğ¾ 45KB)
- Concurrent connections: **1000+**

---

## Ğ¡Ğ»Ğ°Ğ¹Ğ´ 10: SEO Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ

**Dynamic sitemap.xml:**

```php
<?php
header('Content-Type: application/xml; charset=utf-8');
require_once 'config.php';

echo '<?xml version="1.0" encoding="UTF-8"?>';
echo '<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">';

// Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ°
echo '<url><loc>' . BASE_URL . '</loc>';
echo '<changefreq>daily</changefreq>';
echo '<priority>1.0</priority></url>';

// Ğ”Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹ Ñ„Ğ¸Ğ»ÑŒĞ¼Ğ¾Ğ²
$stmt = $pdo->query("
    SELECT id, title, updated_at 
    FROM movies 
    ORDER BY updated_at DESC
");

foreach ($stmt as $movie) {
    echo '<url>';
    echo '<loc>' . BASE_URL . '/film_page.php?id=' . $movie['id'] . '</loc>';
    echo '<lastmod>' . date('Y-m-d', strtotime($movie['updated_at'])) . '</lastmod>';
    echo '<changefreq>monthly</changefreq>';
    echo '<priority>0.6</priority>';
    echo '</url>';
}

echo '</urlset>';
```

**Schema.org structured data:**

```html
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Movie",
    "name": "<?= htmlspecialchars($movie['title']) ?>",
    "datePublished": "<?= $movie['year'] ?>",
    "director": {
        "@type": "Person",
        "name": "<?= htmlspecialchars($movie['director_name']) ?>"
    },
    "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "<?= $movie['rating'] ?>",
        "bestRating": "10"
    }
}
</script>
```

---

## Ğ¡Ğ»Ğ°Ğ¹Ğ´ 11: Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ¸ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸

**Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ°                 â”‚ Ğ—Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Ğ¡Ñ‚Ñ€Ğ¾Ğº ĞºĞ¾Ğ´Ğ° (PHP)        â”‚ ~2500   â”‚
â”‚ Ğ¡Ñ‚Ñ€Ğ¾Ğº ĞºĞ¾Ğ´Ğ° (SQL)        â”‚ ~800    â”‚
â”‚ Ğ¡Ñ‚Ñ€Ğ¾Ğº ĞºĞ¾Ğ´Ğ° (JS)         â”‚ ~400    â”‚
â”‚ Ğ¡Ñ‚Ñ€Ğ¾Ğº ĞºĞ¾Ğ´Ğ° (CSS)        â”‚ ~600    â”‚
â”‚                         â”‚         â”‚
â”‚ Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ Ğ‘Ğ”              â”‚ 6       â”‚
â”‚ Ğ˜Ğ½Ğ´ĞµĞºÑÑ‹                 â”‚ 12      â”‚
â”‚ Triggers                â”‚ 1       â”‚
â”‚                         â”‚         â”‚
â”‚ Ğ¡Ñ‚Ñ€Ğ°Ğ½Ğ¸Ñ† (Ğ¿ÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğµ)     â”‚ 12      â”‚
â”‚ Ğ¡Ñ‚Ñ€Ğ°Ğ½Ğ¸Ñ† (Ğ°Ğ´Ğ¼Ğ¸Ğ½)         â”‚ 8       â”‚
â”‚ API endpoints           â”‚ 3       â”‚
â”‚                         â”‚         â”‚
â”‚ OAuth Ğ¿Ñ€Ğ¾Ğ²Ğ°Ğ¹Ğ´ĞµÑ€Ñ‹        â”‚ 3       â”‚
â”‚ Docker ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ñ‹       â”‚ 3       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸:**

âœ… **Backend:**
- PDO Ñ Prepared Statements
- Ğ”Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ
- Database Transactions
- Automated Migrations
- Connection Pooling

âœ… **Frontend:**
- Real-time AJAX Ğ¿Ğ¾Ğ¸ÑĞº Ñ debouncing
- ĞĞ´Ğ°Ğ¿Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ Ğ´Ğ¸Ğ·Ğ°Ğ¹Ğ½ (Mobile First)
- Semantic HTML5

âœ… **Security:**
- SQL Injection Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ°
- XSS Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ°
- CSRF tokens
- OAuth 2.0 (HMAC verification)

âœ… **DevOps:**
- Docker Compose orchestration
- Nginx reverse proxy + gzip
- PHP OPcache
- PostgreSQL indexing

âœ… **SEO:**
- robots.txt + sitemap.xml
- Meta tags (Open Graph, Schema.org)
- Semantic markup

---

## Ğ¡Ğ»Ğ°Ğ¹Ğ´ 12: ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°

**ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ¿ÑƒÑ‚ÑŒ HTTP Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Browser: GET /films.php?genre=Actionâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Nginx (Port 80)                     â”‚
â”‚    - Gzip compression                  â”‚
â”‚    - Security headers                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ FastCGI
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. PHP-FPM (Port 9000)                 â”‚
â”‚    - config.php (DB + migrations)      â”‚
â”‚    - films.php (business logic)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ SQL Query
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. PostgreSQL (Port 5432)              â”‚
â”‚    - Query planner                     â”‚
â”‚    - Index scan (B-tree)               â”‚
â”‚    - JOIN operations                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ Result rows
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. PHP Template Rendering              â”‚
â”‚    - foreach ($movies as $movie)       â”‚
â”‚    - htmlspecialchars() for XSS        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. HTTP Response                       â”‚
â”‚    Content-Type: text/html             â”‚
â”‚    Content-Encoding: gzip              â”‚
â”‚    + HTML body                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ğ’Ñ€ĞµĞ¼Ñ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ:**
- Nginx routing: ~1ms
- PHP execution: ~30ms
- PostgreSQL query: ~10ms
- Template rendering: ~5ms
- **Total: ~50ms**

---

## Ğ¡Ğ»Ğ°Ğ¹Ğ´ 13: ĞŸĞ°Ñ‚Ñ‚ĞµÑ€Ğ½Ñ‹ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ñ‹:**

1. **Singleton** (Database Connection)
   ```php
   // config.php - ĞµĞ´Ğ¸Ğ½ÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾Ğµ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ
   global $pdo;
   ```

2. **Repository Pattern** (Data Access Layer)
   ```php
   // ĞĞ±ÑÑ‚Ñ€Ğ°ĞºÑ†Ğ¸Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ñ Ğ‘Ğ”
   function getMoviesByGenre($pdo, $genre) {
       $stmt = $pdo->prepare("...");
       return $stmt->fetchAll();
   }
   ```

3. **Middleware Pattern** (Auth)
   ```php
   // auth.php - Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¿ĞµÑ€ĞµĞ´ ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¼ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ¼
   requireAdmin();
   ```

4. **Strategy Pattern** (OAuth Providers)
   ```php
   // Ğ Ğ°Ğ·Ğ½Ñ‹Ğµ ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ğ¸: Telegram, VK, Yandex
   verifyTelegramAuth();
   verifyVKAuth();
   ```

**Security Best Practices:**
- âœ… Prepared Statements (Ğ²ÑĞµĞ³Ğ´Ğ°)
- âœ… CSRF tokens (Ğ²ÑĞµ Ñ„Ğ¾Ñ€Ğ¼Ñ‹)
- âœ… Session regeneration (Ğ¿Ğ¾ÑĞ»Ğµ login)
- âœ… Input validation (filter_var)
- âœ… Output escaping (htmlspecialchars)

**Performance Best Practices:**
- âœ… Database indexing
- âœ… Connection pooling
- âœ… OPcache Ğ´Ğ»Ñ PHP
- âœ… Gzip compression
- âœ… Static assets caching

---

## Ğ¡Ğ»Ğ°Ğ¹Ğ´ 14: Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸ Ñ€Ğ°Ğ·Ğ²Ğ¸Ñ‚Ğ¸Ñ

**ĞšÑ€Ğ°Ñ‚ĞºĞ¾ÑÑ€Ğ¾Ñ‡Ğ½Ñ‹Ğµ ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ¸Ñ:**
1. **REST API**
   ```
   GET    /api/movies       â†’ Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ñ„Ğ¸Ğ»ÑŒĞ¼Ğ¾Ğ² (JSON)
   GET    /api/movies/:id   â†’ Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸ Ñ„Ğ¸Ğ»ÑŒĞ¼Ğ°
   POST   /api/movies       â†’ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ (admin)
   PUT    /api/movies/:id   â†’ ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ
   DELETE /api/movies/:id   â†’ Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ
   ```

2. **Unit Testing (PHPUnit)**
   ```php
   testMovieCreation()
   testSearchFunctionality()
   testOAuthVerification()
   ```

**Ğ¡Ñ€ĞµĞ´Ğ½ĞµÑÑ€Ğ¾Ñ‡Ğ½Ñ‹Ğµ:**
1. **Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° (ML)**
2. **Elasticsearch Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ¸ÑĞºĞ°**
3. **Redis Ğ´Ğ»Ñ ĞºÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ**

**Ğ”Ğ¾Ğ»Ğ³Ğ¾ÑÑ€Ğ¾Ñ‡Ğ½Ñ‹Ğµ:**
1. **Microservices Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°**
2. **GraphQL API**
3. **ĞœĞ¾Ğ±Ğ¸Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ (React Native)**

---

## Ğ¡Ğ»Ğ°Ğ¹Ğ´ 15: Ğ—Ğ°ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ

**Ğ§Ñ‚Ğ¾ Ğ±Ñ‹Ğ»Ğ¾ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¾:**

âœ… **ĞŸĞ¾Ğ»Ğ½Ğ¾Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ²ĞµĞ±-ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°**
- CRUD Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸
- Real-time Ğ¿Ğ¾Ğ¸ÑĞº Ğ±ĞµĞ· Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸
- OAuth 2.0 Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ (3 Ğ¿Ñ€Ğ¾Ğ²Ğ°Ğ¹Ğ´ĞµÑ€Ğ°)
- ĞĞ´Ğ°Ğ¿Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ UI Ğ´Ğ»Ñ Ğ²ÑĞµÑ… ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²

âœ… **Enterprise-grade Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°**
- Ğ¢Ñ€Ñ‘Ñ…Ğ·Ğ²ĞµĞ½Ğ½Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° (Presentation - Business - Data)
- Docker ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ‘Ğ”
- Comprehensive security (CSRF, XSS, SQLi Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ°)

âœ… **Production-ready Ñ€ĞµÑˆĞµĞ½Ğ¸Ğµ**
- SEO Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ (sitemap, meta tags, Schema.org)
- Performance tuning (OPcache, indexes, gzip)
- Error handling Ğ¸ logging

**ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ñ‚ĞµÑ…Ğ½Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ´Ğ¾ÑÑ‚Ğ¸Ğ¶ĞµĞ½Ğ¸Ñ:**
1. Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ°Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ Ğ‘Ğ” Ñ‡ĞµÑ€ĞµĞ· PDO + Prepared Statements
2. OAuth 2.0 Ñ ĞºÑ€Ğ¸Ğ¿Ñ‚Ğ¾Ğ³Ñ€Ğ°Ñ„Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¹ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¾Ğ¹ (HMAC-SHA256)
3. Database transactions Ğ´Ğ»Ñ ACID Ğ³Ğ°Ñ€Ğ°Ğ½Ñ‚Ğ¸Ğ¹
4. Full-text search Ñ PostgreSQL tsvector
5. Automated schema migrations

**Ğ£Ñ‡ĞµĞ±Ğ½Ğ°Ñ Ñ†ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ:**
- ĞŸĞ¾Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ MVC/3-tier architecture
- ĞĞ¿Ñ‹Ñ‚ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ñ PostgreSQL (joins, indexes, constraints)
- ĞŸÑ€Ğ°ĞºÑ‚Ğ¸ĞºĞ° Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
- DevOps skills (Docker, Nginx)
- OAuth 2.0 implementation

---

## ğŸ“ Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚ Ğ´Ğ»Ñ Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ñ‹ (7-10 Ğ¼Ğ¸Ğ½ÑƒÑ‚)

**Ğ¡Ğ»Ğ°Ğ¹Ğ´Ñ‹ 1-2 (1 Ğ¼Ğ¸Ğ½):** "ĞŸÑ€ĞµĞ´ÑÑ‚Ğ°Ğ²Ğ»ÑÑ MoviePortal - Ğ²ĞµĞ±-ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ ĞºĞ°Ñ‚Ğ°Ğ»Ğ¾Ğ³Ğ¾Ğ¼ Ñ„Ğ¸Ğ»ÑŒĞ¼Ğ¾Ğ². Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ° Ğ½Ğ° PHP 8 Ğ¸ PostgreSQL Ñ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼ Docker ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸."

**Ğ¡Ğ»Ğ°Ğ¹Ğ´Ñ‹ 3-4 (2 Ğ¼Ğ¸Ğ½):** "ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ğ¾ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ° Ğ½Ğ° Ñ‚Ñ€Ñ‘Ñ… ÑƒÑ€Ğ¾Ğ²Ğ½ÑÑ… Ğ² Docker ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°Ñ…. Ğ‘Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ½Ğ¾Ñ€Ğ¼Ğ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ° Ğ´Ğ¾ 3ĞĞ¤ Ñ 4 Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ°Ğ¼Ğ¸. Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑ B-tree Ğ¸Ğ½Ğ´ĞµĞºÑÑ‹ Ğ´Ğ»Ñ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ¾Ğ¸ÑĞºĞ°."

**Ğ¡Ğ»Ğ°Ğ¹Ğ´Ñ‹ 5-6 (2 Ğ¼Ğ¸Ğ½):** "Ğ”Ğ»Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ñ Ğ‘Ğ” Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ÑÑ PDO Ñ prepared statements - Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ SQL-Ğ¸Ğ½ÑŠĞµĞºÑ†Ğ¸Ğ¹. Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½ AJAX Ğ¿Ğ¾Ğ¸ÑĞº Ñ debouncing Ğ´Ğ»Ñ ÑĞ½Ğ¸Ğ¶ĞµĞ½Ğ¸Ñ Ğ½Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ Ğ½Ğ° ÑĞµÑ€Ğ²ĞµÑ€."

**Ğ¡Ğ»Ğ°Ğ¹Ğ´ 7 (2 Ğ¼Ğ¸Ğ½):** "ĞĞ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ°Ñ Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ Ğ·Ğ°Ñ‰Ğ¸Ñ‰ĞµĞ½Ğ° Ğ¼Ğ½Ğ¾Ğ³Ğ¾ÑƒÑ€Ğ¾Ğ²Ğ½ĞµĞ²Ğ¾Ğ¹ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ¾Ğ¹: ÑĞµÑÑĞ¸Ğ¾Ğ½Ğ½Ğ°Ñ Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ, CSRF Ñ‚Ğ¾ĞºĞµĞ½Ñ‹, Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ. Ğ”Ğ»Ñ Ğ°Ñ‚Ğ¾Ğ¼Ğ°Ñ€Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑ database transactions."

**Ğ¡Ğ»Ğ°Ğ¹Ğ´ 8 (1 Ğ¼Ğ¸Ğ½):** "Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ° ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¹ Ğ´Ğ»Ñ Ğ²ĞµÑ€ÑĞ¸Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ ÑÑ…ĞµĞ¼Ñ‹ Ğ‘Ğ”. ĞœĞ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¸Ğ´ĞµĞ¼Ğ¿Ğ¾Ñ‚ĞµĞ½Ñ‚Ğ½Ñ‹ Ğ¸ Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ÑÑÑ‚ÑÑ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸."

**Ğ¡Ğ»Ğ°Ğ¹Ğ´Ñ‹ 9-10 (1.5 Ğ¼Ğ¸Ğ½):** "Ğ”Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½Ñ‹ Nginx Ñ gzip ÑĞ¶Ğ°Ñ‚Ğ¸ĞµĞ¼, PHP OPcache, ĞºÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ÑÑ‚Ğ°Ñ‚Ğ¸ĞºĞ¸. ĞŸĞ¾Ğ»Ğ½Ğ°Ñ SEO Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ñ sitemap.xml Ğ¸ Schema.org."

**Ğ¡Ğ»Ğ°Ğ¹Ğ´ 15 (0.5 Ğ¼Ğ¸Ğ½):** "Ğ’ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğµ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ° production-ready ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ñ enterprise-grade Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ¾Ğ¹ Ğ¸ comprehensive security."

---

## ğŸ–¼ï¸ Ğ”ĞµĞ¼Ğ¾Ğ½ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ (3-5 Ğ¼Ğ¸Ğ½ÑƒÑ‚)

1. **docker-compose up** - Ğ·Ğ°Ğ¿ÑƒÑĞº Ğ²ÑĞµĞ¹ Ğ¸Ğ½Ñ„Ñ€Ğ°ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹
2. **Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ°** - Ğ°Ğ´Ğ°Ğ¿Ñ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ (Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€ Ğ¾ĞºĞ½Ğ°)
3. **Live search** - Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ Ğ²Ğ²Ğ¾Ğ´Ğ¸Ñ‚ÑŒ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ„Ğ¸Ğ»ÑŒĞ¼Ğ°
4. **Ğ¡Ñ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° Ñ„Ğ¸Ğ»ÑŒĞ¼Ğ°** - View Source Ñ Schema.org
5. **ĞĞ´Ğ¼Ğ¸Ğ½-Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ** - Ğ²Ñ…Ğ¾Ğ´ Ñ‡ĞµÑ€ĞµĞ· Telegram, Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ñ„Ğ¸Ğ»ÑŒĞ¼
6. **Database** - pgAdmin, Ğ¿Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ¸Ğ½Ğ´ĞµĞºÑÑ‹
7. **Ğ›Ğ¾Ğ³Ğ¸** - `docker-compose logs php`
